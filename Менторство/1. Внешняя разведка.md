# Внешняя разведка

Внешняя разведка в кибербезопасности — это важнейший подготовительный этап, на котором хакер собирает информацию о цели. Собранные данные формируют основу для планирования дальнейших атак. Этот процесс делится на два принципиально разных подхода: [[1. Внешняя разведка#Пассивная разведка|пассивный]] и [[1. Внешняя разведка#Активная разведка|активный]], которые различаются по уровню взаимодействия с целью и, следовательно, по риску быть обнаруженным.

---

# Пассивная разведка

**Пассивная разведка** заключается в сборе информации из открытых источников (OSINT) без прямого взаимодействия с системами или серверами целевой организации. Это похоже на незаметное наблюдение со стороны. Поскольку запросы идут не напрямую к инфраструктуре жертвы, такие действия крайне сложно отследить.

**Примеры методов:**
 >   - **Интернет-мониторинг:** Анализ публичных данных на корпоративном сайте, в социальных сетях, на форумах, в GitHub-репозиториях или новостных агрегаторах. Yandex Dorks, например: `site:company.com filetype:pdf` для обнаружения внутренних документов, их метаданных, почтовых адресов или технических файлов. Shodan, Censis, Fofa. Нейронка [Perplexity](https://www.perplexity.ai/) для сбора инфы со всех сайтов, она автоматизирует методы поиска. Мамонт ([mmnt](https://www.mmnt.ru/)) - поисковик по ftp и smb серверам. в том числе утекшие пароли, ключи и т.д.
>  - **Анализ открытых баз данных:** Просмотр информации в WHOIS (данные о регистраторе домена), на таких сервисах, как DNSDumpster (для поиска связанных поддоменов), или в базе SSL-сертификатов crt.sh для обнаружения всех доменных имен, принадлежащих компании. 
>  - **Сбор информации о сотрудниках:** Составление списков имен, должностей, адресов электронной почты, данных для восстановления паролей из LinkedIn, корпоративных блогов или утечек данных, соц. сети сотрудников, в том числе рабочие соц. сети  (LinkedIn, сетка), их ОС, код и т.д.
>  - **Поиск физических активов:** Количество людей в компании, услуги, с кем работает, финансовое положение, какая целевая аудитория у компании, меры физической безопасности, как идёт взаимодействие и реклама с потенциальными клиентами, какие ещё продукты у компаний, кто разработчики. Для поиска некоторых физических активов можно использовать [Google Earth](https://earth.google.com/web/), [showmystreet.com](https://showmystreet.com/).

Имея имя человека из компании нужно найти его рабочую почту. Привязана ли она к OWA или нет. Можно использовать емейлеры (движки для поиска почт по имени).

---

### Дополнительные инструменты

Дополнительно можно менять поисковики на DackDackGo, Bing (нейросетевые движки), Yahoo и т.д. в соответствии с конкретными странами.

1. [Internet Corporation for Assigned Names and Numbers (ICANN)](https://www.icann.org/ru) - хранит всю информацию об о всех доменах.
2. [Internet Assigned Numbers Authority (IANA)](https://www.iana.org/) - хранит всю информацию об о всех доменах.
3. [RIPE](https://www.ripe.net/)  - хранит всю информацию о доменах Европы.
4. [American Registry for Internet Numbers (ARIN)](https://www.arin.net/) -  хранит всю информацию о доменах Америки.



**BGP Toolkit** — набор инструментов для работы с протоколом BGP (Border Gateway Protocol). Такие инструменты позволяют анализировать информацию о маршрутах, атрибутах BGP и статусе соседей, а также настраивать маршрутизацию в сетях. 

Некоторые инструменты BGP Toolkit:

- **BGPView** [bgpview.io](https://bgpview.io/). Веб-проект, который предоставляет инструмент для веб-браусинга и API для сбора информации о текущем состоянии и структуре интернета, включая ASN, IP-адреса, пиров BGP. Есть карта BGP с данными о распределении IP-адресов по странам.
- **BGP.Tools** [bgp.tools](https://bgp.tools/). Сервис, который отображает разные сети и маршруты между ними, позволяя сетям предоставлять BGP-сессию для обмена маршрутами. Есть поиск по ASN, префиксу, DNS или MAC-адресу.
- **GOBGP** [nms.lcs.mit.edu](https://nms.lcs.mit.edu/software/bgp/bgptools/). Реализация BGP на языке программирования Go, позволяет настраивать и управлять маршрутизацией в сети. Есть интерфейс командной строки и REST-API для настройки и управления маршрутами BGP.
- **BGP Test Tool**. Бесплатный инструмент для тестов соответствия BGP и производительности, предназначен для инженеров-сетевиков.

---

# Активная разведка

**Активная разведка**, напротив, предполагает прямое взаимодействие с инфраструктурой цели. Такие действия оставляют логи на серверах и в сетевых устройствах, что повышает риск обнаружения.

**Примеры методов:**
> - **Сканирование портов:** Использование таких инструментов, как Nmap, для определения, какие сетевые порты открыты на целевых серверах, и какие службы (веб-сервер, база данных) на них работают.
> - **Сканирование уязвимостей:** Активная проверка веб-приложений или сетевых служб на наличие известных уязвимостей с помощью автоматизированных сканеров.
> - **Прямой запрос информации:** Взаимодействие с целью в ожидаемом формате, например, загрузка файлов с публичного сайта компании или даже телефонный звонок под видом клиента (что также относится к социальной инженерии).

По результатам активной разведки необходимо собирать информацию о средствах защиты, информацию о WAF (можно использовать [waf-bypass](https://github.com/nemesida-waf/waf-bypass)), версиях сервисов, уязвимостях, мисконфигурациях. Могут использоваться nikto, nuclei и т.д. Должен быть проведён анализ больших сегментов сети на поиск открытых хостов, портов, шэирпоинтов и их версий.

---

# Результаты разведки

По результатам разведки должна быть собрана вся вышеперечисленная информация, важно знать пул IP, их связь, абстрактную карту DNS, их актуальность, где хостятся и т.д. Иметь представление о потенциально уязвимых местах.

---

### Виртуальные активы, вычисляемые при разведке

1. **Доменные имена и поддомены**
2. **Диапазоны IP-адресов**
3. **Типы и версии сетевых служб** (веб-сервер, FTP, SSH)
4. **Типы и версии операционных систем** на серверах и рабочих станциях
5. **Аппаратные данные** (тип устройства, модель) и **версии прошивок**
6. **Адреса электронной почты сотрудников**
7. **Имена, фамилии и должности сотрудников**
8. **Конкретные веб-приложения** (CRM, порталы) и **используемые технологии** (JavaScript-фреймворки, CMS, версии)
9. **Файлы с конфиденциальной информацией** (PDF-документы, таблицы)

Важно отметить, что большую часть перечисленной информации можно собрать, не отправив ни одного пакета данных напрямую в сеть компании, используя исключительно **пассивные методы**. Это делает разведку массово доступной и труднодосягаемой для предотвращения.

---










